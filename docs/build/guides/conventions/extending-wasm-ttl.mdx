---
title: Extending a deployed contract’s TTL with code
description: How to extend the TTL of a deployed contract's Wasm code using JavaScript SDK.
---
# Extending a deployed contract’s TTL using code

When a smart contract is deployed on the Stellar network, its WebAssembly (Wasm) code has a Time To Live (TTL) that determines how long it remains accessible.

The TTL is the number of ledgers between the current ledger and the final ledger for which the contract data can still be accessed.If the TTL expires, the contract's code becomes archived and inaccessible. To prevent this, you need to periodically extend the TTL of the contract's Wasm code.

This guide will show you how to extend the TTL of a deployed contract's Wasm code using Javascript.

## Prerequisites

- Stellar SDK: `npm install @stellar/stellar-sdk`
- A Soroban RPC endpoint (e.g., `https://soroban-testnet.stellar.org`)
- Basic knowledge of Stellar SDK

## Process Overview

- Get the contract's Footprint,
- Set a reasonble resource Fee, maybe from 10,000 stroops because its a costly operation,
- Set soroban data as read only, 
- Set the desired ledger TTL to expire the contract,
- Create an operation StellarSdk.Operation.extendFootprintTtl
- Resource fee and base fee are both charged in this operation

## Javascript Code

The code below uses Nodejs environment but can also be aplied in the browser using freighter wallet or using any other [Stellar SDK](/docs/tools/sdks/library).
    
```javascript
import * as StellarSdk from "@stellar/stellar-sdk";

import { Server } from "@stellar/stellar-sdk/rpc";

async function extendContractWasmTTL(contractId, sourceKeypair) {
  const server = new Server("https://soroban-testnet.stellar.org");

  // Create a new transaction builder
  const account = await server.getAccount(sourceKeypair.publicKey());
  const fee = "200100"; // Base fee plus resource fee

  // Get the contract instance
  const contract = new StellarSdk.Contract(contractId);
  const instance = contract.getFootprint();

  // Set the Soroban data and create an operation to extend the contract's TTL
  const sorobanData = new StellarSdk.SorobanDataBuilder()
    .setResourceFee(200_000)
    .setReadOnly([instance])
    .build();
  const transaction = new StellarSdk.TransactionBuilder(account, {
    fee,
    networkPassphrase: StellarSdk.Networks.TESTNET, // Use appropriate network
  })
    .setSorobanData(sorobanData)
    .addOperation(
      StellarSdk.Operation.extendFootprintTtl({
        extendTo: 500_000
      })
    )
    .setTimeout(30)
    .build();
    
  // Sign and submit the transaction
  transaction.sign(sourceKeypair);
  const result = await server.sendTransaction(transaction);

  console.log(
    "Transaction submitted. Result:",
    JSON.stringify(result, null, 2)
  );
  return result;
}

// Usage
const contractId = "CC6MWZMG2JPQEENRL7XVICAY5RNMHJ2OORMUHXKRDID6MNGXSSOJZLLF";
const sourceKeypair = StellarSdk.Keypair.fromSecret(
  "SXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
);

extendContractWasmTTL(contractId, sourceKeypair)
  .then(console.log)
  .catch(console.error);
```

In the above code, we first import the required modules and define the `extendContractWasmTTL` function. This function takes the contract ID and the source keypair as arguments. It then creates a new transaction builder and fetches the contract's Wasm hash. Next, it sets the Soroban data and creates an operation to extend the contract's TTL. Finally, it signs and submits the transaction.

Read more about the [Extend Footprint Ttl operation](docs/learn/encyclopedia/storage/state-archival#extendfootprintttlop) operation here.